"use strict";var __awaiter=this&&this.__awaiter||function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function u(t){try{s(n.next(t))}catch(t){i(t)}}function a(t){try{s(n.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(u,a)}s((n=n.apply(t,e||[])).next())}))},__generator=this&&this.__generator||function(t,e){var r,n,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;u;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,n=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=e.call(t,u)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.each=exports.getKeysOfItems=exports.getValuesOfItems=exports.getAmountOfItems=exports.getManyByCondition=exports.purgeManyByCondition=exports.getMany=exports.purgeMany=exports.destroy=exports.prune=exports.purge=exports.has=exports.update=exports.view=exports.get=exports.set=void 0;var store=[],maxAmount=1/0,maxAge=1/0;exports.default=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e,r;return __generator(this,(function(n){return maxAmount=null!==(e=t.maxAmount)&&void 0!==e?e:1/0,maxAge=null!==(r=t.maxAge)&&void 0!==r?r:1/0,[2]}))}))};var set=function(t,e){return __awaiter(void 0,void 0,void 0,(function(){var r;return __generator(this,(function(n){return-1!==store.findIndex((function(e){return e[0]===t}))?[2,!1]:((store=store.filter((function(t){return Date.now()-t[2]<1e3*maxAge}))).length===maxAmount&&(r=store.reduce((function(t,e){return t[2]<e[2]?t:e})),store.splice(store.findIndex((function(t){return t[0]===r[0]})),1)),store.push([t,e,Date.now()]),[2,!0])}))}))};exports.set=set;var get=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e;return __generator(this,(function(r){return store=store.filter((function(t){return Date.now()-t[2]<1e3*maxAge})),-1===(e=store.findIndex((function(e){return e[0]===t})))?[2,null]:[2,store[e][1]]}))}))};exports.get=get;var view=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e;return __generator(this,(function(r){return store=store.filter((function(e){return Date.now()-e[2]<1e3*maxAge||e[0]===t})),-1===(e=store.findIndex((function(e){return e[0]===t})))?[2,null]:[2,store[e][1]]}))}))};exports.view=view;var update=function(t,e){return __awaiter(void 0,void 0,void 0,(function(){var r;return __generator(this,(function(n){return-1===(r=store.findIndex((function(e){return e[0]===t})))?[2,!1]:(store[r]=[t,e,Date.now()],[2,!0])}))}))};exports.update=update;var has=function(t){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(e){return-1===store.findIndex((function(e){return e[0]===t}))?[2,!1]:[2,!0]}))}))};exports.has=has;var purge=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e;return __generator(this,(function(r){return-1===(e=store.findIndex((function(e){return e[0]===t})))?[2,!1]:(store.splice(e,1),[2,!0])}))}))};exports.purge=purge;var prune=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return store.length>0&&(store=store.filter((function(t){return Date.now()-t[2]<1e3*maxAge}))),[2,!0]}))}))};exports.prune=prune;var destroy=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return store=[],[2,!0]}))}))};exports.destroy=destroy;var purgeMany=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e,r,n;return __generator(this,(function(o){switch(o.label){case 0:e=0,r=t,o.label=1;case 1:return e<r.length?(n=r[e],[4,(0,exports.purge)(n)]):[3,4];case 2:o.sent(),o.label=3;case 3:return e++,[3,1];case 4:return[2,!0]}}))}))};exports.purgeMany=purgeMany;var getMany=function(t){return __awaiter(void 0,void 0,void 0,(function(){var e,r,n,o,i;return __generator(this,(function(u){switch(u.label){case 0:e=[],r=0,n=t,u.label=1;case 1:return r<n.length?(o=n[r],[4,(0,exports.get)(o)]):[3,4];case 2:null===(i=u.sent())&&void 0===i||e.push(i),u.label=3;case 3:return r++,[3,1];case 4:return[2,e]}}))}))};exports.getMany=getMany;var purgeManyByCondition=function(t){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(e){return store=store.filter((function(e){return!t(e)})),[2,!0]}))}))};exports.purgeManyByCondition=purgeManyByCondition;var getManyByCondition=function(t){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(e){return[2,store.filter((function(e){return t(e)}))]}))}))};exports.getManyByCondition=getManyByCondition;var getAmountOfItems=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return[2,store.length]}))}))};exports.getAmountOfItems=getAmountOfItems;var getValuesOfItems=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return 0===store.length?[2]:[2,store.map((function(t){return t[1]}))]}))}))};exports.getValuesOfItems=getValuesOfItems;var getKeysOfItems=function(){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(t){return 0===store.length?[2]:[2,store.map((function(t){return t[0]}))]}))}))};exports.getKeysOfItems=getKeysOfItems;var each=function(t){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(e){return store.forEach((function(e){return __awaiter(void 0,void 0,void 0,(function(){return __generator(this,(function(r){switch(r.label){case 0:return[4,t(e)];case 1:return r.sent(),[2]}}))}))})),[2,!0]}))}))};exports.each=each;